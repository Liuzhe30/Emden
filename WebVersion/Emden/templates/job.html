<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1,user-scalable=no">

    <!-- loading css -->
    <link rel="stylesheet" href="/Emden/static/css/bootstrap.css">
    <link rel='stylesheet' href='/Emden/static/css/css.css?family=serif:800'>
<!--    <link rel="stylesheet" href="/Emden/static/css/span_style_v2.css">-->
    <link rel="stylesheet" href="/Emden/static/lib/bootstrap-slider/css/bootstrap-slider.css">
    <link rel="stylesheet" href="/Emden/static/lib/bootstrap-table/dist/bootstrap-table.css">
    <link rel="stylesheet" href="/Emden/static/lib/bootstrap-select/dist/css/bootstrap-select.css">
    <link rel="stylesheet" href="/Emden/static/lib/jquery-ui-1.12.1.custom/jquery-ui.min.css">
    <link rel="stylesheet" href="/Emden/static/lib/bootstrap-fileinput/css/fileinput.css">
    {#    <!-- miRNASNP3 css -->#}
    <link rel="stylesheet" href="/Emden/static/css/main.css">
    <link rel="stylesheet" href="/Emden/static/css/job.css">

    <!-- loading javascripts -->
    <script src="/Emden/static/lib/jquery/jquery-3.1.1.min.js"></script>
    <script src="/Emden/static/lib/jquery-ui-1.12.1.custom/jquery-ui.js"></script>
    <script src="/Emden/static/lib/bootstrap/bootstrap.js"></script>
    <script src="/Emden/static/lib/ui-bootstrap/ui-bootstrap-tpls-2.4.0.js"></script>
    <script src="/Emden/static/lib/bootstrap-slider/bootstrap-slider.js"></script>
    <script src="/Emden/static/lib/bootstrap-select/js/bootstrap-select.js"></script>
    <script src="/Emden/static/lib/fornac/dist/scripts/fornac.js"></script>
    <script src="/Emden/static/lib/bootstrap-fileinput/js/fileinput.js"></script>
    <script src="/Emden/static/lib/bootstrap-table/dist/bootstrap-table.js"></script>
    <script src="/Emden/static/lib/bootstrap-table/src/extensions/export/bootstrap-table-export.js"></script>
    <script src="/Emden/static/js/bootstrap-table-export.js"></script>
    <script src="/Emden/static/js/tableExport.js"></script>




    <!-- for icon -->
    <link rel="icon" href="/Emden/static/img/logo.png">
    <title>Emden</title>

</head>

<style type="text/css">
html {
    zoom: 80%;
}
.n-col-md-6 {
  position: relative;
  min-height: 1px;
  padding-right: 15px;
  padding-left: 15px;
  font-size: 20px;
  text-align: center;
}

.logo {
    text-align: center; 
    border-radius: 20px;
    margin: auto;
    position: relative;
    left: 0;
    right: 0;
}
</style>

<body>
<!-- website logo -->

<div class="logo" style="width: 80%; font-size: 120px; top: 15px; font-family: 'serif', sans-serif;color: #ffe01b">
    <a href="/Emden">
        <img src="/Emden/static/img/mainlogo.png" alt="Emden" id="logo-banner" width="20%">
    </a>
</div>

<!-- navigation -->
{% include 'navigation.html' %}

{# {% for message in get_flashed_messages() %}#}
{#    <p style="color: red;">{{ message }}</p>#}
{#{% endfor %}#}

<!-- main container -->
<div class="container" style = "font-family: sans-serif">
    <div class="page-header">
        <h2>Details for job (refreash this page for getting results)</h2>
    </div>
    <table class="table table-striped table-hover">
        <thead>
        <tr>
            <td><strong>Job id:</strong></td>
            <td><a class="text-left">{{ results.get('job_id') }}</a></td>
        </tr>
        </thead>
        <tbody>
        {% if  results.get('job_name') %}
            <tr>
                <td><strong>job name: </strong></td>
                <td><a class="text-left">{{ results['job_name'] }}</a></td>
            </tr>
        {% endif %}
        <tr>
            <td><strong>latest status: </strong></td>
            <td><a class="text-left">{{ results.get('job_state') }}</a></td>
        </tr>
        <tr>
            <td><strong>latest update time: </strong></td>
            <td><a class="text-left">{{ results.get('time') }}</a></td>
        </tr>
        <tr>
            <td><strong>original sequence: </strong></td>
            <td><a class="text-left">{{ results.get('seq') }}</a></td>
        </tr>
        <tr>
            <td><strong>mutation site: </strong></td>
            <td><a class="text-left">{{ results.get('mupos') }}</a></td>
        </tr>
        <tr>
            <td><strong>mutation after: </strong></td>
            <td><a class="text-left">{{ results.get('muafter') }}</a></td>
        </tr>
        <tr>
            <td><strong>drug name: </strong></td>
            <td><a class="text-left">{{ results.get('drugname') }}</a></td>
        </tr>
        </tbody>
    </table>
    <h2>Predict results</h2>
            <div class="page-header">
        </div>
    {% if not results.get('result') %}
        <div style="font-size: 30px;
     color: #956BBB;
     text-align: center;
     font-weight: bold;
     background-color: #17234B;
"
    >
    Predicting... please wait
    </div>

    You can also check the job status later using URL: <a class="text-left">https://psymukb.net/Emden/job/{{ results.get('job_id') }}</a>

    {% endif %}

    {% if results.get('result') %}

    <div style="font-size: 50px;
     color: #956BBB;
     text-align: center;
     font-weight: bold;
     background-color: #17234B;">
        {{ results['result'] }}
    </div>
    <div style="font-size: 20px;
     color: black;
     text-align: center;
     font-weight: bold;
         "
    >
        The probability of the given mutation to impact the {{ results.get('drugname') }} response
    </div>


    {% if results.get('result') >= 0.5 %}
        <div style="font-size: 50px;
     color: #956BBB;
     text-align: center;
     font-weight: bold;
     background-color: #17234B;">
    Sensitive
    </div>
    <div style="font-size: 20px;
     color: black;
     text-align: center;
     font-weight: bold;
         "
    >
        Our model predicts that the given mutation will impact the {{ results.get('drugname') }} response with cutoff 0.5
    </div>
    {% else %}
            <div style="font-size: 50px;
     color: #956BBB;
     text-align: center;
     font-weight: bold;
     background-color: #17234B;">
     Non-sensitive
    </div>
    <div style="font-size: 20px;
     color: black;
     text-align: center;
     font-weight: bold;
         "
    >
        Our model predicts that the given mutation will not impact the {{ results.get('drugname') }} response with cutoff 0.5
    </div>
    {% endif %}

<h2>Fingerprint Attention Visualization</h2>
        <div class="page-header">
        </div>
    <img src="{{'/Emden/static/img/fingerprint-attention-vis' + results.get('job_id') + '.png'}}" alt="attention visualzation" width="100%">
 {% endif %}
<h2>Drug Structure</h2>
        <div class="page-header">
        </div>
<iframe class="pubchem-widget" src="https://pubchem.ncbi.nlm.nih.gov/compound/{{ results.get('drugname') }}#section=3D-Conformer&embed=true" style="width: 100%; max-width: 100%; height: 700px;"></iframe>


</div>
</body>


</html>
